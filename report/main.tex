\documentclass[11pt]{article}
\usepackage[a4paper, top=0.5in, bottom=0.6in, left=0.6in, right=0.6in]{geometry}

\usepackage{sectsty}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{float}
\usepackage{caption}

\title{ \bf Results: [20, 35] Crossings }
\author{ Jake Weatherhead }
\date{}
\begin{document}
\maketitle	
\vspace{-1em}
\noindent
The CNN (88M params) and ViT (86M params) were fine-tuned on a new dataset $\mathcal{D}$ comprising unknot $\mathcal{U}$ and non-trivial knot
$\mathcal{K}$ diagrams partitioned into three disjoint data splits $S := \{$train, val, test$\}$, where:\vspace{-0.2em}

\[
\begin{gathered}
\mathcal{D} \; = \; \biguplus_{s \in S} \mathcal{D}_s \\[0.5em]
|\mathcal{D}| \; = \; 560{,}000 \,\text{ diagrams, } \\[0.5em]
|\mathcal{D}_{\mathrm{train}}| \; = \; 0.8 \cdot |\mathcal{D}| \; = \; 448{,}000 \text{ diagrams,} \\[0.5em]
|\mathcal{D}_{\mathrm{val}}| \; = \; |\mathcal{D}_{\mathrm{test}}| \; = \; 0.1 \cdot |\mathcal{D}| \; = \; 56{,}000 \text{ diagrams}, \\[0.5em]
\text{where } \; \forall s \in S, \;\, s \in \; \mathcal{U}_s \, \cup \, \mathcal{K}_s \; \text{ and } \; |\mathcal{U}_s| = |\mathcal{K}_s|. \\[0.5em]
\end{gathered}
\]

\noindent
Each split contained knot diagrams for every crossing count $n \in N := \{20, \, 21, \, \ldots \,, \,35 \}$.
For all $x, y \in N$, $x \neq y$, each split in $S$ contained an equal number of $x$ and $y$-crossing unknot and non-trivial knot diagrams.

\section*{Learning Curves}
\vspace{-0.5em}
\begin{figure}[H]
   \centering
   \includegraphics[width=0.66\textwidth]{/home/jake/Personal/SeeingTheUnknot/report/tikz/NOV-MON-10/cnn-lc.png}
   \includegraphics[width=0.66\textwidth]{/home/jake/Personal/SeeingTheUnknot/report/tikz/NOV-MON-10/vit-lc.png}
\end{figure}
\vspace{-2em}

\newpage
\newgeometry{a4paper, top=0.9in, bottom=0.9in, left=0.6in, right=0.6in}
\section*{Test Accuracy by Crossing Count}

Let CNN* and ViT* denote the models with the highest test classification accuracies.

\begin{figure}[H]
   \centering
   \includegraphics[width=0.9\textwidth]{/home/jake/Personal/SeeingTheUnknot/report/acc-by-nc.png}
\end{figure}


\section*{CNN* Saliency Maps}

A sample of CNN* saliency maps for knot diagrams in $\mathcal{D}_{\mathrm{test}}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CNN* TP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{True Positives: Unknots Predicted as Unknots}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/cnn/TP/cnn-tp.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ unknot diagrams in $\mathcal{D}_{test}$, CNN* produced $27{,}677$ true positives.}
   \label{fig:cnn-fn}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CNN* FN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{False Negatives: Unknots Predicted as Non-Trivial}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/cnn/FN/cnn-fn.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ unknot diagrams in $\mathcal{D}_{test}$, CNN* produced 323 false negatives.}
   \label{fig:cnn-fn}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CNN* TN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{True Negatives: Non-Trivials Predicted as Non-Trivial}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/cnn/TN/cnn-tn.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ non-trivial knot diagrams in $\mathcal{D}_{test}$, CNN* produced $27{,}020$ true negatives.}
   \label{fig:cnn-fn}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CNN* FP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{False Positives: Non-Trivials Predicted as Unknots}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/cnn/FP/cnn-fp.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ non-trivial knot diagrams in $\mathcal{D}_{test}$, CNN* produced $980$ false positives.}
   \label{fig:cnn-fp}
\end{figure}
\section*{ViT* Saliency Maps}

A sample of ViT* saliency maps for knot diagrams in $\mathcal{D}_{\mathrm{test}}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ViT* TP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{True Positives: Unknots Predicted as Unknots}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/vit/TP/vit-tp.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ unknot diagrams in $\mathcal{D}_{test}$, ViT* produced $25{,}630$ true positives.}
   \label{fig:vit-fn}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ViT* FN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{False Negatives: Unknots Predicted as Non-Trivial}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/vit/FN/vit-fn.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ unknot diagrams in $\mathcal{D}_{test}$, ViT* produced $2{,}370$ false negatives.}
   \label{fig:vit-fn}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ViT* TN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{True Negatives: Non-Trivials Predicted as Non-Trivial}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/vit/TN/vit-tn.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ non-trivial knot diagrams in $\mathcal{D}_{test}$, ViT* produced $24{,}252$ true negatives.}
   \label{fig:vit-fn}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ViT* FP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{False Positives: Non-Trivials Predicted as Unknots}
\vspace{-1.8em}
\begin{figure}[H]
   \centering
   \includegraphics[width=1\textwidth]{tikz/NOV-MON-10/vit/FP/vit-fp.pdf}
   \captionsetup{skip=0pt}
   \caption{Of the $28{,}000$ non-trivial knot diagrams in $\mathcal{D}_{test}$, ViT* produced $3{,}748$ false positives.}
   \label{fig:vit-fp}
\end{figure}

\section*{Further Evidence of Learning}

Let $m_{v}$ denote checkpoint model $m \in \{\text{CNN}, \text{ViT}\}$ with validation accuracy $v$. The figures below are examples
of a model $m$ initially misclassifying a knot diagram $d \in \mathcal{D}_{test}$, later learning to correctly classify $d$.
Let $p$ and $t$ respectively denote the predicted and true triviality of $d$ as given by model $m_v$. 

\begin{figure}[H]
   \centering
   \includegraphics[width=0.9\textwidth]{/home/jake/Personal/SeeingTheUnknot/report/tikz/NOV-MON-10/corrections/cnn/cnn-corrections.pdf}
   \captionsetup{skip=0pt}
   \label{fig:vit-fp}
\end{figure}

\end{document}